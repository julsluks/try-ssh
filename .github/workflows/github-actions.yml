name: Try SSH Deploy

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    name: Deploy to Staging server
    uses: easingthemes/try-ssh@main
    with:
      SSH_PRIVATE_KEY: ${{ secrets.KEY_SECRET }}
      ARGS: "-rlgoDzvc -i"
      SOURCE: "/"
      REMOTE_HOST: ${{ secrets.REMOTE_HOST }}
      REMOTE_USER: ${{ secrets.REMOTE_USER }}
      TARGET: ${{ secrets.REMOTE_TARGET }}
      EXCLUDE: "/dist/, /node_modules/"
      SCRIPT_BEFORE: |
        whoami
        ls -al
      SCRIPT_AFTER: |
        whoami
        ls -al
        echo $RSYNC_STDOUT